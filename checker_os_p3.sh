#!/bin/bash
#set -x

declare -i nota=0
declare -i incremento=1


# ****************************************


testeo(){
   echo "File: " $1
   echo "Nprod: " $2
   echo "MCons: " $3
   echo "max_bank_accounts: " $4
   echo "Buffsize: " $5
   ./bank $1 $2 $3 $4 $5 > out_bank  2>/dev/null
   if diff -i -w -q --ignore-all-space $6 out_bank > /dev/null; then
      echo " OK"
      cat out_bank
      echo -n "1 " >> excel
      nota=$(( nota + incremento ))
      echo $nota
   else
      echo " Error"
      echo -n "0 " >> excel
      echo " === test === "
      cat  $1
      echo " === output ./bank  === "
      cat  out_bank
      echo " === expected output  === "
      cat  $6
   fi
   rm -f out*
   echo
   echo
}

testeoError(){
   echo "File: " $1
   echo "Nprod: " $2
   echo "MCons: " $3
   echo "max_bank_accounts: " $4
   echo "Buffsize: " $5
   eval ./bank $1 $2 $3 $4 $5 > /dev/null 2> /dev/null
   if [ $? -eq 0 ];
   then
      echo " Wrong returned value"
      echo -n "0 " >> excel
   else
      echo " OK"
      echo -n "1 " >> excel
      nota=$(( nota + incremento ))
      echo $nota
   fi
   echo
   echo
}

testeoErrorParams(){
   echo "File: " $1
   echo "Nprod: " $2
   echo "MCons: " $3
   echo "max_bank_accounts: " $4
   echo "Buffsize: " $5
   echo "Extra arg: " $6
   eval ./bank $1 $2 $3 $4 $5 $6 > /dev/null 2> /dev/null
   if [ $? -eq 0 ];
   then
      echo " Wrong returned value"
      echo -n "0 " >> excel
   else
      echo " OK"
      echo -n "1 " >> excel
      nota=$(( nota + incremento ))
      echo $nota
   fi
   echo
   echo
}


#*****************************************


if [ -z "$1" ]
  then
    echo "No argument supplied"
    exit
fi

clear

echo "*** TESTING P3 "


TDIR="./testdir"
mkdir $TDIR
cp $1 $TDIR

echo "File : $1"

cd $TDIR

text="50
CREATE 1
DEPOSIT 1 100
CREATE 2
DEPOSIT 2 50
TRANSFER 1 2 30
TRANSFER 2 1 20
WITHDRAW 1 40
WITHDRAW 2 60
BALANCE 1
BALANCE 2
CREATE 3
DEPOSIT 3 20
CREATE 4
DEPOSIT 4 500
TRANSFER 3 4 10
TRANSFER 4 3 200
WITHDRAW 3 5
WITHDRAW 4 100
BALANCE 3
BALANCE 4
CREATE 5
DEPOSIT 5 1000
CREATE 6
DEPOSIT 6 250
TRANSFER 5 6 600
TRANSFER 6 5 150
WITHDRAW 5 80
WITHDRAW 6 300
BALANCE 5
BALANCE 6
CREATE 7
DEPOSIT 7 300
CREATE 8
DEPOSIT 8 30
TRANSFER 7 8 25
TRANSFER 8 7 50
WITHDRAW 7 250
WITHDRAW 8 5
BALANCE 7
BALANCE 8
CREATE 9
DEPOSIT 9 300
CREATE 10
DEPOSIT 10 30
TRANSFER 9 10 25
TRANSFER 10 9 50
WITHDRAW 9 250
WITHDRAW 10 5
BALANCE 9
BALANCE 10"
echo -e "$text" > 50-50.test

text2="50
CREATE 1
DEPOSIT 1 100
CREATE 2
DEPOSIT 2 50
TRANSFER 1 2 30
TRANSFER 2 1 20
WITHDRAW 1 40
WITHDRAW 2 60
BALANCE 1
BALANCE 2
CREATE 3
DEPOSIT 3 20
CREATE 4
DEPOSIT 4 500
TRANSFER 3 4 10
TRANSFER 4 3 200
WITHDRAW 3 5
WITHDRAW 4 100
BALANCE 3
BALANCE 4
CREATE 5
DEPOSIT 5 1000
CREATE 6
DEPOSIT 6 250
TRANSFER 5 6 600
TRANSFER 6 5 150
WITHDRAW 5 80
WITHDRAW 6 300
BALANCE 5
BALANCE 6
CREATE 7
DEPOSIT 7 300
CREATE 8
DEPOSIT 8 30
TRANSFER 7 8 25
TRANSFER 8 7 50
WITHDRAW 7 250
WITHDRAW 8 5
BALANCE 7
BALANCE 8
CREATE 9
DEPOSIT 9 300
CREATE 10
DEPOSIT 10 30
TRANSFER 9 10 25
TRANSFER 10 9 50
WITHDRAW 9 250
WITHDRAW 10 5
BALANCE 9
BALANCE 10
CREATE 11
DEPOSIT 11 100
CREATE 12
DEPOSIT 12 50
TRANSFER 11 12 30
TRANSFER 12 11 20
WITHDRAW 11 40
WITHDRAW 12 60
BALANCE 11
BALANCE 12
CREATE 13
DEPOSIT 13 20
CREATE 14
DEPOSIT 14 500
TRANSFER 13 14 10
TRANSFER 14 13 200
WITHDRAW 13 5
WITHDRAW 14 100
BALANCE 13
BALANCE 14
CREATE 15
DEPOSIT 15 1000
CREATE 16
DEPOSIT 16 250
TRANSFER 15 16 600
TRANSFER 16 15 150
WITHDRAW 15 80
WITHDRAW 16 300
BALANCE 15
BALANCE 16
CREATE 17
DEPOSIT 17 300
CREATE 18
DEPOSIT 18 30
TRANSFER 17 18 25
TRANSFER 18 17 50
WITHDRAW 17 250
WITHDRAW 18 5
BALANCE 17
BALANCE 18
CREATE 19
DEPOSIT 19 300
CREATE 20
DEPOSIT 20 30
TRANSFER 19 20 25
TRANSFER 20 19 50
WITHDRAW 19 250
WITHDRAW 20 5
BALANCE 19
BALANCE 20
CREATE 21
DEPOSIT 21 100
CREATE 22
DEPOSIT 22 50
TRANSFER 21 22 30
TRANSFER 22 21 20
WITHDRAW 21 40
WITHDRAW 22 60
BALANCE 21
BALANCE 22
CREATE 23
DEPOSIT 23 20
CREATE 24
DEPOSIT 24 500
TRANSFER 23 24 10
TRANSFER 24 23 200
WITHDRAW 23 5
WITHDRAW 24 100
BALANCE 23
BALANCE 24
CREATE 25
DEPOSIT 25 1000
CREATE 26
DEPOSIT 26 250
TRANSFER 25 26 600
TRANSFER 26 25 150
WITHDRAW 25 80
WITHDRAW 26 300
BALANCE 25
BALANCE 26
CREATE 27
DEPOSIT 27 300
CREATE 28
DEPOSIT 28 30
TRANSFER 27 28 25
TRANSFER 28 27 50
WITHDRAW 27 250
WITHDRAW 28 5
BALANCE 27
BALANCE 28
CREATE 29
DEPOSIT 29 300
CREATE 30
DEPOSIT 30 30
TRANSFER 29 30 25
TRANSFER 30 29 50
WITHDRAW 29 250
WITHDRAW 30 5
BALANCE 29
BALANCE 30
CREATE 31
DEPOSIT 31 100
CREATE 32
DEPOSIT 32 50
TRANSFER 31 32 30
TRANSFER 32 31 20
WITHDRAW 31 40
WITHDRAW 31 60
BALANCE 31
BALANCE 32
CREATE 33
DEPOSIT 33 20
CREATE 34
DEPOSIT 34 500
TRANSFER 33 34 10
TRANSFER 34 33 200
WITHDRAW 33 5
WITHDRAW 34 100
BALANCE 33
BALANCE 34
CREATE 35
DEPOSIT 35 1000
CREATE 36
DEPOSIT 36 250
TRANSFER 35 36 600
TRANSFER 36 35 150
WITHDRAW 35 80
WITHDRAW 36 300
BALANCE 35
BALANCE 36
CREATE 37
DEPOSIT 37 300
CREATE 38
DEPOSIT 38 30
TRANSFER 37 38 25
TRANSFER 38 37 50
WITHDRAW 37 250
WITHDRAW 38 5
BALANCE 37
BALANCE 38
CREATE 39
DEPOSIT 39 300
CREATE 40
DEPOSIT 40 30
TRANSFER 39 40 25
TRANSFER 40 39 50
WITHDRAW 39 250
WITHDRAW 40 5
BALANCE 39
BALANCE 40"
echo -e "$text2" > 50-200.test

text3="200
CREATE 1
DEPOSIT 1 100
CREATE 2
DEPOSIT 2 50
TRANSFER 1 2 30
TRANSFER 2 1 20
WITHDRAW 1 40
WITHDRAW 2 60
BALANCE 1
BALANCE 2
CREATE 3
DEPOSIT 3 20
CREATE 4
DEPOSIT 4 500
TRANSFER 3 4 10
TRANSFER 4 3 200
WITHDRAW 3 5
WITHDRAW 4 100
BALANCE 3
BALANCE 4
CREATE 5
DEPOSIT 5 1000
CREATE 6
DEPOSIT 6 250
TRANSFER 5 6 600
TRANSFER 6 5 150
WITHDRAW 5 80
WITHDRAW 6 300
BALANCE 5
BALANCE 6
CREATE 7
DEPOSIT 7 300
CREATE 8
DEPOSIT 8 30
TRANSFER 7 8 25
TRANSFER 8 7 50
WITHDRAW 7 250
WITHDRAW 8 5
BALANCE 7
BALANCE 8
CREATE 9
DEPOSIT 9 300
CREATE 10
DEPOSIT 10 30
TRANSFER 9 10 25
TRANSFER 10 9 50
WITHDRAW 9 250
WITHDRAW 10 5
BALANCE 9
BALANCE 10"
echo -e "$text3" > 200-50.test

text4="200
CREATE 1
DEPOSIT 1 100
CREATE 2
DEPOSIT 2 50
TRANSFER 1 2 30
TRANSFER 2 1 20
WITHDRAW 1 40
WITHDRAW 2 60
BALANCE 1
BALANCE 2
CREATE 3
DEPOSIT 3 20
CREATE 4
DEPOSIT 4 500
TRANSFER 3 4 10
TRANSFER 4 3 200
WITHDRAW 3 5
WITHDRAW 4 100
BALANCE 3
BALANCE 4
CREATE 5
DEPOSIT 5 1000
CREATE 6
DEPOSIT 6 250
TRANSFER 5 6 600
TRANSFER 6 5 150
WITHDRAW 5 80
WITHDRAW 6 300
BALANCE 5
BALANCE 6
CREATE 7
DEPOSIT 7 300
CREATE 8
DEPOSIT 8 30
TRANSFER 7 8 25
TRANSFER 8 7 50
WITHDRAW 7 250
WITHDRAW 8 5
BALANCE 7
BALANCE 8
CREATE 9
DEPOSIT 9 300
CREATE 10
DEPOSIT 10 30
TRANSFER 9 10 25
TRANSFER 10 9 50
WITHDRAW 9 250
WITHDRAW 10 5
BALANCE 9
BALANCE 10
CREATE 11
DEPOSIT 11 100
CREATE 12
DEPOSIT 12 50
TRANSFER 11 12 30
TRANSFER 12 11 20
WITHDRAW 11 40
WITHDRAW 12 60
BALANCE 11
BALANCE 12
CREATE 13
DEPOSIT 13 20
CREATE 14
DEPOSIT 14 500
TRANSFER 13 14 10
TRANSFER 14 13 200
WITHDRAW 13 5
WITHDRAW 14 100
BALANCE 13
BALANCE 14
CREATE 15
DEPOSIT 15 1000
CREATE 16
DEPOSIT 16 250
TRANSFER 15 16 600
TRANSFER 16 15 150
WITHDRAW 15 80
WITHDRAW 16 300
BALANCE 15
BALANCE 16
CREATE 17
DEPOSIT 17 300
CREATE 18
DEPOSIT 18 30
TRANSFER 17 18 25
TRANSFER 18 17 50
WITHDRAW 17 250
WITHDRAW 18 5
BALANCE 17
BALANCE 18
CREATE 19
DEPOSIT 19 300
CREATE 20
DEPOSIT 20 30
TRANSFER 19 20 25
TRANSFER 20 19 50
WITHDRAW 19 250
WITHDRAW 20 5
BALANCE 19
BALANCE 20
CREATE 21
DEPOSIT 21 100
CREATE 22
DEPOSIT 22 50
TRANSFER 21 22 30
TRANSFER 22 21 20
WITHDRAW 21 40
WITHDRAW 22 60
BALANCE 21
BALANCE 22
CREATE 23
DEPOSIT 23 20
CREATE 24
DEPOSIT 24 500
TRANSFER 23 24 10
TRANSFER 24 23 200
WITHDRAW 23 5
WITHDRAW 24 100
BALANCE 23
BALANCE 24
CREATE 25
DEPOSIT 25 1000
CREATE 26
DEPOSIT 26 250
TRANSFER 25 26 600
TRANSFER 26 25 150
WITHDRAW 25 80
WITHDRAW 26 300
BALANCE 25
BALANCE 26
CREATE 27
DEPOSIT 27 300
CREATE 28
DEPOSIT 28 30
TRANSFER 27 28 25
TRANSFER 28 27 50
WITHDRAW 27 250
WITHDRAW 28 5
BALANCE 27
BALANCE 28
CREATE 29
DEPOSIT 29 300
CREATE 30
DEPOSIT 30 30
TRANSFER 29 30 25
TRANSFER 30 29 50
WITHDRAW 29 250
WITHDRAW 30 5
BALANCE 29
BALANCE 30
CREATE 31
DEPOSIT 31 100
CREATE 32
DEPOSIT 32 50
TRANSFER 31 32 30
TRANSFER 32 31 20
WITHDRAW 31 40
WITHDRAW 31 60
BALANCE 31
BALANCE 32
CREATE 33
DEPOSIT 33 20
CREATE 34
DEPOSIT 34 500
TRANSFER 33 34 10
TRANSFER 34 33 200
WITHDRAW 33 5
WITHDRAW 34 100
BALANCE 33
BALANCE 34
CREATE 35
DEPOSIT 35 1000
CREATE 36
DEPOSIT 36 250
TRANSFER 35 36 600
TRANSFER 36 35 150
WITHDRAW 35 80
WITHDRAW 36 300
BALANCE 35
BALANCE 36
CREATE 37
DEPOSIT 37 300
CREATE 38
DEPOSIT 38 30
TRANSFER 37 38 25
TRANSFER 38 37 50
WITHDRAW 37 250
WITHDRAW 38 5
BALANCE 37
BALANCE 38
CREATE 39
DEPOSIT 39 300
CREATE 40
DEPOSIT 40 30
TRANSFER 39 40 25
TRANSFER 40 39 50
WITHDRAW 39 250
WITHDRAW 40 5
BALANCE 39
BALANCE 40"
echo -e "$text4" > 200-200.test

unzip $1
touch empty.test
touch no_perm.test
chmod -r no_perm.test
chmod -w no_perm.test


if [ ! -f authors.txt ]; then
   echo "Error: missing authors.txt file"
   cd ..
   rm -r $TDIR
   exit
fi


make clean 2> /dev/null > /dev/null
make       2> /dev/null > /dev/null


echo "Compiling"
if [ ! -f bank ]; then
   echo "Error: does not compile"
   cd ..
   exit
else
   echo "OK"
fi


# BUILDING TESTS

res="1 CREATE 1 BALANCE=0 TOTAL=0
2 DEPOSIT 1 100 BALANCE=100 TOTAL=100
3 CREATE 2 BALANCE=0 TOTAL=100
4 DEPOSIT 2 50 BALANCE=50 TOTAL=150
5 TRANSFER 1 2 30 BALANCE=80 TOTAL=150
6 TRANSFER 2 1 20 BALANCE=90 TOTAL=150
7 WITHDRAW 1 40 BALANCE=50 TOTAL=110
8 WITHDRAW 2 60 BALANCE=0 TOTAL=50
9 BALANCE 1 BALANCE=50 TOTAL=50
10 BALANCE 2 BALANCE=0 TOTAL=50
11 CREATE 3 BALANCE=0 TOTAL=50
12 DEPOSIT 3 20 BALANCE=20 TOTAL=70
13 CREATE 4 BALANCE=0 TOTAL=70
14 DEPOSIT 4 500 BALANCE=500 TOTAL=570
15 TRANSFER 3 4 10 BALANCE=510 TOTAL=570
16 TRANSFER 4 3 200 BALANCE=210 TOTAL=570
17 WITHDRAW 3 5 BALANCE=205 TOTAL=565
18 WITHDRAW 4 100 BALANCE=210 TOTAL=465
19 BALANCE 3 BALANCE=205 TOTAL=465
20 BALANCE 4 BALANCE=210 TOTAL=465
21 CREATE 5 BALANCE=0 TOTAL=465
22 DEPOSIT 5 1000 BALANCE=1000 TOTAL=1465
23 CREATE 6 BALANCE=0 TOTAL=1465
24 DEPOSIT 6 250 BALANCE=250 TOTAL=1715
25 TRANSFER 5 6 600 BALANCE=850 TOTAL=1715
26 TRANSFER 6 5 150 BALANCE=550 TOTAL=1715
27 WITHDRAW 5 80 BALANCE=470 TOTAL=1635
28 WITHDRAW 6 300 BALANCE=400 TOTAL=1335
29 BALANCE 5 BALANCE=470 TOTAL=1335
30 BALANCE 6 BALANCE=400 TOTAL=1335
31 CREATE 7 BALANCE=0 TOTAL=1335
32 DEPOSIT 7 300 BALANCE=300 TOTAL=1635
33 CREATE 8 BALANCE=0 TOTAL=1635
34 DEPOSIT 8 30 BALANCE=30 TOTAL=1665
35 TRANSFER 7 8 25 BALANCE=55 TOTAL=1665
36 TRANSFER 8 7 50 BALANCE=325 TOTAL=1665
37 WITHDRAW 7 250 BALANCE=75 TOTAL=1415
38 WITHDRAW 8 5 BALANCE=0 TOTAL=1410
39 BALANCE 7 BALANCE=75 TOTAL=1410
40 BALANCE 8 BALANCE=0 TOTAL=1410
41 CREATE 9 BALANCE=0 TOTAL=1410
42 DEPOSIT 9 300 BALANCE=300 TOTAL=1710
43 CREATE 10 BALANCE=0 TOTAL=1710
44 DEPOSIT 10 30 BALANCE=30 TOTAL=1740
45 TRANSFER 9 10 25 BALANCE=55 TOTAL=1740
46 TRANSFER 10 9 50 BALANCE=325 TOTAL=1740
47 WITHDRAW 9 250 BALANCE=75 TOTAL=1490
48 WITHDRAW 10 5 BALANCE=0 TOTAL=1485
49 BALANCE 9 BALANCE=75 TOTAL=1485
50 BALANCE 10 BALANCE=0 TOTAL=1485"
echo -e "$res" > 50-50.res

res2="1 CREATE 1 BALANCE=0 TOTAL=0
2 DEPOSIT 1 100 BALANCE=100 TOTAL=100
3 CREATE 2 BALANCE=0 TOTAL=100
4 DEPOSIT 2 50 BALANCE=50 TOTAL=150
5 TRANSFER 1 2 30 BALANCE=80 TOTAL=150
6 TRANSFER 2 1 20 BALANCE=90 TOTAL=150
7 WITHDRAW 1 40 BALANCE=50 TOTAL=110
8 WITHDRAW 2 60 BALANCE=0 TOTAL=50
9 BALANCE 1 BALANCE=50 TOTAL=50
10 BALANCE 2 BALANCE=0 TOTAL=50
11 CREATE 3 BALANCE=0 TOTAL=50
12 DEPOSIT 3 20 BALANCE=20 TOTAL=70
13 CREATE 4 BALANCE=0 TOTAL=70
14 DEPOSIT 4 500 BALANCE=500 TOTAL=570
15 TRANSFER 3 4 10 BALANCE=510 TOTAL=570
16 TRANSFER 4 3 200 BALANCE=210 TOTAL=570
17 WITHDRAW 3 5 BALANCE=205 TOTAL=565
18 WITHDRAW 4 100 BALANCE=210 TOTAL=465
19 BALANCE 3 BALANCE=205 TOTAL=465
20 BALANCE 4 BALANCE=210 TOTAL=465
21 CREATE 5 BALANCE=0 TOTAL=465
22 DEPOSIT 5 1000 BALANCE=1000 TOTAL=1465
23 CREATE 6 BALANCE=0 TOTAL=1465
24 DEPOSIT 6 250 BALANCE=250 TOTAL=1715
25 TRANSFER 5 6 600 BALANCE=850 TOTAL=1715
26 TRANSFER 6 5 150 BALANCE=550 TOTAL=1715
27 WITHDRAW 5 80 BALANCE=470 TOTAL=1635
28 WITHDRAW 6 300 BALANCE=400 TOTAL=1335
29 BALANCE 5 BALANCE=470 TOTAL=1335
30 BALANCE 6 BALANCE=400 TOTAL=1335
31 CREATE 7 BALANCE=0 TOTAL=1335
32 DEPOSIT 7 300 BALANCE=300 TOTAL=1635
33 CREATE 8 BALANCE=0 TOTAL=1635
34 DEPOSIT 8 30 BALANCE=30 TOTAL=1665
35 TRANSFER 7 8 25 BALANCE=55 TOTAL=1665
36 TRANSFER 8 7 50 BALANCE=325 TOTAL=1665
37 WITHDRAW 7 250 BALANCE=75 TOTAL=1415
38 WITHDRAW 8 5 BALANCE=0 TOTAL=1410
39 BALANCE 7 BALANCE=75 TOTAL=1410
40 BALANCE 8 BALANCE=0 TOTAL=1410
41 CREATE 9 BALANCE=0 TOTAL=1410
42 DEPOSIT 9 300 BALANCE=300 TOTAL=1710
43 CREATE 10 BALANCE=0 TOTAL=1710
44 DEPOSIT 10 30 BALANCE=30 TOTAL=1740
45 TRANSFER 9 10 25 BALANCE=55 TOTAL=1740
46 TRANSFER 10 9 50 BALANCE=325 TOTAL=1740
47 WITHDRAW 9 250 BALANCE=75 TOTAL=1490
48 WITHDRAW 10 5 BALANCE=0 TOTAL=1485
49 BALANCE 9 BALANCE=75 TOTAL=1485
50 BALANCE 10 BALANCE=0 TOTAL=1485
51 CREATE 11 BALANCE=0 TOTAL=1485
52 DEPOSIT 11 100 BALANCE=100 TOTAL=1585
53 CREATE 12 BALANCE=0 TOTAL=1585
54 DEPOSIT 12 50 BALANCE=50 TOTAL=1635
55 TRANSFER 11 12 30 BALANCE=80 TOTAL=1635
56 TRANSFER 12 11 20 BALANCE=90 TOTAL=1635
57 WITHDRAW 11 40 BALANCE=50 TOTAL=1595
58 WITHDRAW 12 60 BALANCE=0 TOTAL=1535
59 BALANCE 11 BALANCE=50 TOTAL=1535
60 BALANCE 12 BALANCE=0 TOTAL=1535
61 CREATE 13 BALANCE=0 TOTAL=1535
62 DEPOSIT 13 20 BALANCE=20 TOTAL=1555
63 CREATE 14 BALANCE=0 TOTAL=1555
64 DEPOSIT 14 500 BALANCE=500 TOTAL=2055
65 TRANSFER 13 14 10 BALANCE=510 TOTAL=2055
66 TRANSFER 14 13 200 BALANCE=210 TOTAL=2055
67 WITHDRAW 13 5 BALANCE=205 TOTAL=2050
68 WITHDRAW 14 100 BALANCE=210 TOTAL=1950
69 BALANCE 13 BALANCE=205 TOTAL=1950
70 BALANCE 14 BALANCE=210 TOTAL=1950
71 CREATE 15 BALANCE=0 TOTAL=1950
72 DEPOSIT 15 1000 BALANCE=1000 TOTAL=2950
73 CREATE 16 BALANCE=0 TOTAL=2950
74 DEPOSIT 16 250 BALANCE=250 TOTAL=3200
75 TRANSFER 15 16 600 BALANCE=850 TOTAL=3200
76 TRANSFER 16 15 150 BALANCE=550 TOTAL=3200
77 WITHDRAW 15 80 BALANCE=470 TOTAL=3120
78 WITHDRAW 16 300 BALANCE=400 TOTAL=2820
79 BALANCE 15 BALANCE=470 TOTAL=2820
80 BALANCE 16 BALANCE=400 TOTAL=2820
81 CREATE 17 BALANCE=0 TOTAL=2820
82 DEPOSIT 17 300 BALANCE=300 TOTAL=3120
83 CREATE 18 BALANCE=0 TOTAL=3120
84 DEPOSIT 18 30 BALANCE=30 TOTAL=3150
85 TRANSFER 17 18 25 BALANCE=55 TOTAL=3150
86 TRANSFER 18 17 50 BALANCE=325 TOTAL=3150
87 WITHDRAW 17 250 BALANCE=75 TOTAL=2900
88 WITHDRAW 18 5 BALANCE=0 TOTAL=2895
89 BALANCE 17 BALANCE=75 TOTAL=2895
90 BALANCE 18 BALANCE=0 TOTAL=2895
91 CREATE 19 BALANCE=0 TOTAL=2895
92 DEPOSIT 19 300 BALANCE=300 TOTAL=3195
93 CREATE 20 BALANCE=0 TOTAL=3195
94 DEPOSIT 20 30 BALANCE=30 TOTAL=3225
95 TRANSFER 19 20 25 BALANCE=55 TOTAL=3225
96 TRANSFER 20 19 50 BALANCE=325 TOTAL=3225
97 WITHDRAW 19 250 BALANCE=75 TOTAL=2975
98 WITHDRAW 20 5 BALANCE=0 TOTAL=2970
99 BALANCE 19 BALANCE=75 TOTAL=2970
100 BALANCE 20 BALANCE=0 TOTAL=2970
101 CREATE 21 BALANCE=0 TOTAL=2970
102 DEPOSIT 21 100 BALANCE=100 TOTAL=3070
103 CREATE 22 BALANCE=0 TOTAL=3070
104 DEPOSIT 22 50 BALANCE=50 TOTAL=3120
105 TRANSFER 21 22 30 BALANCE=80 TOTAL=3120
106 TRANSFER 22 21 20 BALANCE=90 TOTAL=3120
107 WITHDRAW 21 40 BALANCE=50 TOTAL=3080
108 WITHDRAW 22 60 BALANCE=0 TOTAL=3020
109 BALANCE 21 BALANCE=50 TOTAL=3020
110 BALANCE 22 BALANCE=0 TOTAL=3020
111 CREATE 23 BALANCE=0 TOTAL=3020
112 DEPOSIT 23 20 BALANCE=20 TOTAL=3040
113 CREATE 24 BALANCE=0 TOTAL=3040
114 DEPOSIT 24 500 BALANCE=500 TOTAL=3540
115 TRANSFER 23 24 10 BALANCE=510 TOTAL=3540
116 TRANSFER 24 23 200 BALANCE=210 TOTAL=3540
117 WITHDRAW 23 5 BALANCE=205 TOTAL=3535
118 WITHDRAW 24 100 BALANCE=210 TOTAL=3435
119 BALANCE 23 BALANCE=205 TOTAL=3435
120 BALANCE 24 BALANCE=210 TOTAL=3435
121 CREATE 25 BALANCE=0 TOTAL=3435
122 DEPOSIT 25 1000 BALANCE=1000 TOTAL=4435
123 CREATE 26 BALANCE=0 TOTAL=4435
124 DEPOSIT 26 250 BALANCE=250 TOTAL=4685
125 TRANSFER 25 26 600 BALANCE=850 TOTAL=4685
126 TRANSFER 26 25 150 BALANCE=550 TOTAL=4685
127 WITHDRAW 25 80 BALANCE=470 TOTAL=4605
128 WITHDRAW 26 300 BALANCE=400 TOTAL=4305
129 BALANCE 25 BALANCE=470 TOTAL=4305
130 BALANCE 26 BALANCE=400 TOTAL=4305
131 CREATE 27 BALANCE=0 TOTAL=4305
132 DEPOSIT 27 300 BALANCE=300 TOTAL=4605
133 CREATE 28 BALANCE=0 TOTAL=4605
134 DEPOSIT 28 30 BALANCE=30 TOTAL=4635
135 TRANSFER 27 28 25 BALANCE=55 TOTAL=4635
136 TRANSFER 28 27 50 BALANCE=325 TOTAL=4635
137 WITHDRAW 27 250 BALANCE=75 TOTAL=4385
138 WITHDRAW 28 5 BALANCE=0 TOTAL=4380
139 BALANCE 27 BALANCE=75 TOTAL=4380
140 BALANCE 28 BALANCE=0 TOTAL=4380
141 CREATE 29 BALANCE=0 TOTAL=4380
142 DEPOSIT 29 300 BALANCE=300 TOTAL=4680
143 CREATE 30 BALANCE=0 TOTAL=4680
144 DEPOSIT 30 30 BALANCE=30 TOTAL=4710
145 TRANSFER 29 30 25 BALANCE=55 TOTAL=4710
146 TRANSFER 30 29 50 BALANCE=325 TOTAL=4710
147 WITHDRAW 29 250 BALANCE=75 TOTAL=4460
148 WITHDRAW 30 5 BALANCE=0 TOTAL=4455
149 BALANCE 29 BALANCE=75 TOTAL=4455
150 BALANCE 30 BALANCE=0 TOTAL=4455
151 CREATE 31 BALANCE=0 TOTAL=4455
152 DEPOSIT 31 100 BALANCE=100 TOTAL=4555
153 CREATE 32 BALANCE=0 TOTAL=4555
154 DEPOSIT 32 50 BALANCE=50 TOTAL=4605
155 TRANSFER 31 32 30 BALANCE=80 TOTAL=4605
156 TRANSFER 32 31 20 BALANCE=90 TOTAL=4605
157 WITHDRAW 31 40 BALANCE=50 TOTAL=4565
158 WITHDRAW 31 60 BALANCE=-10 TOTAL=4505
159 BALANCE 31 BALANCE=-10 TOTAL=4505
160 BALANCE 32 BALANCE=60 TOTAL=4505
161 CREATE 33 BALANCE=0 TOTAL=4505
162 DEPOSIT 33 20 BALANCE=20 TOTAL=4525
163 CREATE 34 BALANCE=0 TOTAL=4525
164 DEPOSIT 34 500 BALANCE=500 TOTAL=5025
165 TRANSFER 33 34 10 BALANCE=510 TOTAL=5025
166 TRANSFER 34 33 200 BALANCE=210 TOTAL=5025
167 WITHDRAW 33 5 BALANCE=205 TOTAL=5020
168 WITHDRAW 34 100 BALANCE=210 TOTAL=4920
169 BALANCE 33 BALANCE=205 TOTAL=4920
170 BALANCE 34 BALANCE=210 TOTAL=4920
171 CREATE 35 BALANCE=0 TOTAL=4920
172 DEPOSIT 35 1000 BALANCE=1000 TOTAL=5920
173 CREATE 36 BALANCE=0 TOTAL=5920
174 DEPOSIT 36 250 BALANCE=250 TOTAL=6170
175 TRANSFER 35 36 600 BALANCE=850 TOTAL=6170
176 TRANSFER 36 35 150 BALANCE=550 TOTAL=6170
177 WITHDRAW 35 80 BALANCE=470 TOTAL=6090
178 WITHDRAW 36 300 BALANCE=400 TOTAL=5790
179 BALANCE 35 BALANCE=470 TOTAL=5790
180 BALANCE 36 BALANCE=400 TOTAL=5790
181 CREATE 37 BALANCE=0 TOTAL=5790
182 DEPOSIT 37 300 BALANCE=300 TOTAL=6090
183 CREATE 38 BALANCE=0 TOTAL=6090
184 DEPOSIT 38 30 BALANCE=30 TOTAL=6120
185 TRANSFER 37 38 25 BALANCE=55 TOTAL=6120
186 TRANSFER 38 37 50 BALANCE=325 TOTAL=6120
187 WITHDRAW 37 250 BALANCE=75 TOTAL=5870
188 WITHDRAW 38 5 BALANCE=0 TOTAL=5865
189 BALANCE 37 BALANCE=75 TOTAL=5865
190 BALANCE 38 BALANCE=0 TOTAL=5865
191 CREATE 39 BALANCE=0 TOTAL=5865
192 DEPOSIT 39 300 BALANCE=300 TOTAL=6165
193 CREATE 40 BALANCE=0 TOTAL=6165
194 DEPOSIT 40 30 BALANCE=30 TOTAL=6195
195 TRANSFER 39 40 25 BALANCE=55 TOTAL=6195
196 TRANSFER 40 39 50 BALANCE=325 TOTAL=6195
197 WITHDRAW 39 250 BALANCE=75 TOTAL=5945
198 WITHDRAW 40 5 BALANCE=0 TOTAL=5940
199 BALANCE 39 BALANCE=75 TOTAL=5940
200 BALANCE 40 BALANCE=0 TOTAL=5940"
echo -e "$res2" > 200-200.res

# ERROR TESTS

testeoErrorParams 50-50.test 1 2 3 4 5
testeoError 50-50.test -1 1 1 1
testeoError 50-50.test 1 -1 1 1
testeoError 50-50.test 1 1 -1 1
testeoError 50-50.test 1 1 1 -1

# TESTS WITH FILES

testeo 50-50.test 3 2 10 10 50-50.res
testeoError 200-50.test 3 2 20 10
testeo 200-200.test 3 2 40 10 200-200.res
testeoError 50-200.test 3 2 20 10

# TESTING CONCURRENCY WITH DIFFERENT VALUES OF NPROD AND BUFFSIZE

testeo 200-200.test 1 1 40 10 200-200.res
testeo 200-200.test 1 1 40 2000 200-200.res
testeo 200-200.test 3 3 40 10 200-200.res
testeo 200-200.test 4 4 40 50 200-200.res
testeo 200-200.test 5 5 40 500 200-200.res
testeo 200-200.test 6 6 40 2000 200-200.res
testeo 200-200.test 4 4 40 2000 200-200.res
testeo 200-200.test 5 5 40 200 200-200.res
testeo 200-200.test 6 6 40 10 200-200.res

# GRADE & DELETE FILES

fnota=$((echo scale=2 ; echo $nota*10 / 18) | bc )
echo "Grade: $fnota"
echo $fnota > ../grade.txt

cp authors.txt ..
cd ..

rm -rf testdir